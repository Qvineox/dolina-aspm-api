syntax = "proto3";

package dolina.workers.v1;

option go_package = "gitlab.domsnail.ru/dolina/dolina-aspm-api/api/gen/go/workers.proto/v1;workers_v1";

import "components/v1/component.proto";
import "reports/v1/analysis.proto";
import "reports/v1/report.proto";
import "defects/v1/defect.proto";

message AnalysisProcessStream {
  string report_uuid = 1;

  reports.v1.AnalysisState current_state = 3;

  oneof processed_artifacts {
    ComponentArtifacts components = 4;
    DefectArtifacts defects = 5;
    ReportArtifacts report = 6;
  }

  // worker_id, analysis_uuid, report_uuid must be added to metadata
}

message ComponentArtifacts {
  repeated components.v1.Component component_list = 1;
}

message DefectArtifacts {
  repeated defects.v1.Defect defect_list = 1;
}

message ReportArtifacts {
  repeated reports.v1.Report report_list = 1;
}

message AnalysisProcessSummary {

}
