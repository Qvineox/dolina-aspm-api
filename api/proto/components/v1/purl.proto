edition = "2023";

package dolina.components.v1;

option go_package = "gitlab.domsnail.ru/dolina/dolina-aspm-api/api/gen/go/components/v1;components_v1";
option features.(pb.go).api_level = API_OPAQUE;
option features.field_presence = IMPLICIT;

import "google/protobuf/go_features.proto";

// ref: https://github.com/package-url/purl-spec
// ref: https://tc54.org/purl/

message PURL {
  // string representation of a purl
  string instance = 1;

  // the package "type" or package "protocol" such as maven, npm, nuget, gem, pypi, etc.
  string type = 2;

  // a name prefix such as a Maven group id, a Docker image owner, a GitHub user or organization. Namespace is type-specific.
  string namespace = 3 [features.field_presence = EXPLICIT];

  // the name of the package.
  string name = 4;

  // the name of the package.
  string version = 5 [features.field_presence = EXPLICIT];

  // qualifier data for a package such as OS, architecture, repository, etc. Qualifiers are type-specific.
  map<string, string> qualifiers = 6;

  // subpath within a package, relative to the package root.
  string subpath = 7 [features.field_presence = EXPLICIT];
}