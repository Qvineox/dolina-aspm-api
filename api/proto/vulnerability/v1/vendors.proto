edition = "2023";

package dolina.vulnerability.v1;

option go_package = "gitlab.domsnail.ru/dolina/dolina-aspm-api/api/gen/go/vulnerability/v1;vulnerability_v1";
option features.(pb.go).api_level = API_OPAQUE;
option features.field_presence = EXPLICIT;

import "protoc-gen-openapiv2/options/annotations.proto";
import "google/protobuf/go_features.proto";

import "cvss/v2/severity.proto";
import "cvss/v3/severity.proto";
import "cvss/v4/severity.proto";

message Vendor {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Vendor"
      description: "Vendor entity representing a software or service provider in the ASPM system. "
          "Includes identification details, name, description, external references, and audit timestamps for "
          "tracking vendor information."
    }
  };

  uint32 id = 1;
  string name = 2;

  string url = 3;
}

message VendorScoring {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Vendor scoring"
      description: "Vendor risk assessment and scoring model. Contains vendor identifier, computed security score, "
          "risk factors, assessment methodology details, and timestamps for score validity and updates."
    }
  };

  Vendor vendor = 1;

  cvss.v2.Severity cvss2_severity = 2;
  cvss.v3.Severity cvss3_severity = 3;
  cvss.v4.Severity cvss4_severity = 4;

  float cvss2_score = 5;
  float cvss3_score = 6;
  float cvss4_score = 7;

  //  optional string severity = 5;

  string source_url = 8;
}

//enum Severity {
//  CVSS_SEVERITY_UNSPECIFIED = 0;
//
//  CVSS_SEVERITY_LOW = 1;
//  CVSS_SEVERITY_MEDIUM = 2;
//  CVSS_SEVERITY_HIGH = 3;
//
//  CVSS_SEVERITY_CRITICAL = 4;
//}

