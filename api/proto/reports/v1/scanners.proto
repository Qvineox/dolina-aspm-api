edition = "2023";

package dolina.reports.v1;

option go_package = "gitlab.domsnail.ru/dolina/dolina-aspm-api/api/gen/go/reports/v1;reports_v1";
option features.(pb.go).api_level = API_OPAQUE;

import "protoc-gen-openapiv2/options/annotations.proto";
import "google/protobuf/go_features.proto";

message ScannerReport {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Scanner Report"
      description: "A report generated by an external security scanner (e.g., Trivy, Semgrep, Snyk). "
          "It encapsulates raw findings, scan metadata (scanner name, version, timestamp), "
          "target information (repository, image, file path), and any additional context "
          "required for ingestion. This report serves as the primary input to Dolina ASPM "
          "for normalization, deduplication, and risk analysis."
    }
  };


  string uploaded_file_uuid = 1;

  ScannerID scanner_id = 2 [features.field_presence = EXPLICIT];
  ScannerFormat scanner_format = 3 [features.field_presence = EXPLICIT];
}

enum ScannerID {
  SCANNER_ID_UNSPECIFIED = 0;

  SCANNER_ID_TRIVY = 1;
  SCANNER_ID_GITLEAKS = 2;
}

enum ScannerFormat {
  SCANNER_FORMAT_UNSPECIFIED = 0;

  SCANNER_FORMAT_TRIVY_FS = 1;
  SCANNER_FORMAT_SARIF = 2;
  SCANNER_FORMAT_SBOM = 3;
  SCANNER_FORMAT_GITLEAKS = 4;
}