edition = "2023";

package dolina.reports.v1;

option go_package = "gitlab.domsnail.ru/dolina/dolina-aspm-api/api/gen/go/reports/v1;reports_v1";
option features.(pb.go).api_level = API_OPAQUE;

import "protoc-gen-openapiv2/options/annotations.proto";
import "google/protobuf/go_features.proto";

import "reports/v1/scanners.proto";

message Report {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    json_schema: {
      title: "Report"
      description: "A comprehensive security assessment report generated by Dolina ASPM after "
          "analyzing one or more scanner reports. It contains normalized findings, "
          "risk scores, severity classifications, remediation recommendations, and "
          "contextual metadata (e.g., affected components, code locations). This report "
          "provides a unified view of the application's security posture, enabling "
          "prioritization and tracking of vulnerabilities across the software development lifecycle."
    }
  };

  string uuid = 1;

  repeated ScannerReport scanner_reports = 2;

  // membership attributes
  uint32 project_id = 3 [features.field_presence = EXPLICIT];
  uint32 application_id = 4 [features.field_presence = EXPLICIT];
  string repository_uuid = 5 [features.field_presence = EXPLICIT];
  string artifact_uuid = 6 [features.field_presence = EXPLICIT];

  // ci/cd attributes
  string pipeline_id = 8 [features.field_presence = EXPLICIT];

  // todo: report data
}

message ReportPatch {
  string uuid = 1;
}