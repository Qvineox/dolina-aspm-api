syntax = "proto3";

package dolina.reports.v1;

option go_package = "gitlab.domsnail.ru/dolina/dolina-aspm-api/api/gen/go/analysis.proto/v1;reports_v1";

import "google/api/annotations.proto";
import "reports/v1/analysis.proto";
import "reports/v1/scanners.proto";
import "common/v1/paging.proto";

message Report {
  string uuid = 1;
}

message Reports {
  repeated Report reports = 1;
}

message ReportPatch {
  string uuid = 1;
}

message ReportsQueryFilter {
  optional uint64 project_id = 2;
  optional string project_slug = 3; // ignored if project_id is provided

  // create or update project repository by provided attributes
  optional string repository_uuid = 4;
  optional string repository_url = 5; // ignored if repository_uuid is provided

  // create or update project artifact by provided attributes
  optional string artifact_uuid = 6;
  optional string artifact_purl = 7;

  optional ScannerID scanner_id = 8;
  optional ScannerFormat scanner_format = 9;

  common.v1.Paging paging = 20;
}