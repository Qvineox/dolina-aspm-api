{
  "swagger": "2.0",
  "info": {
    "title": "Dolina ASPM API",
    "description": "API for the Dolina Application Security Posture Management (ASPM) system. Enables ingestion of security scanner reports, management of application components, and retrieval of unified security analysis reports.",
    "version": "0.1.0-dev",
    "contact": {
      "name": "Yaroslav Lysak",
      "url": "https://github.com/Qvineox",
      "email": "lysal.yaroslav00@yandex.ru"
    },
    "license": {
      "name": "Proprietary"
    }
  },
  "tags": [
    {
      "name": "CLI",
      "description": "Methods user by a Dolina CLI module"
    },
    {
      "name": "ComponentsService"
    },
    {
      "name": "ProjectService"
    },
    {
      "name": "AnalysisService"
    },
    {
      "name": "ReportsService"
    },
    {
      "name": "DefectsService"
    },
    {
      "name": "ReportProcessingService"
    },
    {
      "name": "WorkerQueueService"
    }
  ],
  "host": "0.0.0.0:80",
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/api/v1/components": {
      "get": {
        "operationId": "ComponentsService_GetComponentsByQueryFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1ComponentsQueryResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "purl",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "repositoryUuid",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "repositoryRef",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "artifactUuid",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "pagination.limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          }
        ],
        "tags": [
          "ComponentsService"
        ]
      }
    },
    "/api/v1/components/{uuid}": {
      "get": {
        "operationId": "ComponentsService_GetComponentByUUID",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Component"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "ComponentsService"
        ]
      }
    },
    "/api/v1/defects": {
      "get": {
        "operationId": "DefectsService_GetDefectsByQueryFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1DefectsQueryResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "title",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "componentPurl",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "applicationId",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "applicationRef",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "paging.offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "paging.limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          }
        ],
        "tags": [
          "DefectsService"
        ]
      }
    },
    "/api/v1/defects/{uuid}": {
      "get": {
        "operationId": "DefectsService_GetDefectByUUID",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Defect"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "DefectsService"
        ]
      }
    },
    "/api/v1/projects": {
      "get": {
        "operationId": "ProjectService_GetProjectsByQueryFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1ProjectsList"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "slug",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "name",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "tags",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string"
            },
            "collectionFormat": "multi"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          }
        ],
        "tags": [
          "ProjectService"
        ]
      },
      "put": {
        "operationId": "ProjectService_CreateProject",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Project"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1Project"
            }
          }
        ],
        "tags": [
          "ProjectService"
        ]
      }
    },
    "/api/v1/projects/{id}": {
      "get": {
        "operationId": "ProjectService_GetProject",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Project"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "slug",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "name",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "tags",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string"
            },
            "collectionFormat": "multi"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          }
        ],
        "tags": [
          "ProjectService"
        ]
      },
      "patch": {
        "operationId": "ProjectService_UpdateProject",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Project"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ProjectServiceUpdateProjectBody"
            }
          }
        ],
        "tags": [
          "ProjectService"
        ]
      }
    },
    "/api/v1/projects/{projectId}/{id}": {
      "patch": {
        "operationId": "ProjectService_UpdateProjectRevision",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Revision"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ProjectServiceUpdateProjectRevisionBody"
            }
          }
        ],
        "tags": [
          "ProjectService"
        ]
      }
    },
    "/api/v1/projects/{projectId}/{revisionId}": {
      "get": {
        "operationId": "ProjectService_GetProjectRevision",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Revision"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "revisionId",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "projectSlug",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "ProjectService"
        ]
      }
    },
    "/api/v1/projects/{projectSlug}/{revisionId}": {
      "get": {
        "operationId": "ProjectService_GetProjectRevision2",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Revision"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "projectSlug",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "revisionId",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "projectId",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          }
        ],
        "tags": [
          "ProjectService"
        ]
      }
    },
    "/api/v1/projects/{slug}": {
      "get": {
        "operationId": "ProjectService_GetProject2",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Project"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "id",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "name",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "tags",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string"
            },
            "collectionFormat": "multi"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          }
        ],
        "tags": [
          "ProjectService"
        ]
      }
    },
    "/api/v1/reports": {
      "get": {
        "operationId": "ReportsService_GetReportsByQueryFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1ReportsQueryResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "projectId",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "projectSlug",
            "description": "ignored if project_id is provided",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "applicationId",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "applicationSlug",
            "description": "ignored if application_id is provided",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "repositoryUuid",
            "description": "create or update project repository by provided attributes",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "repositoryUrl",
            "description": "ignored if repository_uuid is provided",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "artifactUuid",
            "description": "create or update project artifact by provided attributes",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "artifactPurl",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "scannerId",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "SCANNER_ID_UNSPECIFIED",
              "SCANNER_ID_TRIVY",
              "SCANNER_ID_GITLEAKS"
            ],
            "default": "SCANNER_ID_UNSPECIFIED"
          },
          {
            "name": "scannerFormat",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "SCANNER_FORMAT_UNSPECIFIED",
              "SCANNER_FORMAT_TRIVY_FS",
              "SCANNER_FORMAT_SARIF",
              "SCANNER_FORMAT_SBOM",
              "SCANNER_FORMAT_GITLEAKS"
            ],
            "default": "SCANNER_FORMAT_UNSPECIFIED"
          },
          {
            "name": "pipelineId",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "pagination.limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          }
        ],
        "tags": [
          "ReportsService"
        ]
      }
    },
    "/api/v1/reports/analysis/{uuid}": {
      "get": {
        "operationId": "AnalysisService_GetAnalysisStatusByReportUUID",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AnalysisStatus"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AnalysisService"
        ]
      }
    },
    "/api/v1/reports/analyze": {
      "post": {
        "summary": "Asynchronous method for reports analysis, always returns uncertain info",
        "operationId": "AnalysisService_AnalyzeUnary",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AnalysisStatus"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Contextual metadata accompanying a raw scanner report. It provides information about the environment in which the scan was executed, such as the repository URL, Git reference (branch, tag, commit), pipeline or build ID, and any other relevant deployment or runtime context. This data is used by Dolina ASPM to enrich, filter, and correlate findings with specific code versions or build stages.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1AnalyzeOptions"
            }
          }
        ],
        "tags": [
          "AnalysisService"
        ]
      }
    },
    "/api/v1/reports/{uuid}": {
      "get": {
        "operationId": "ReportsService_GetReportByUUID",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Report"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "ReportsService"
        ]
      },
      "delete": {
        "operationId": "ReportsService_DeleteReportByUUID",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "ReportsService"
        ]
      },
      "patch": {
        "operationId": "ReportsService_PatchReport",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Report"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ReportsServicePatchReportBody"
            }
          }
        ],
        "tags": [
          "ReportsService"
        ]
      }
    }
  },
  "definitions": {
    "ProjectServiceUpdateProjectBody": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "slug": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "tagList": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "vcsUrl": {
          "type": "string"
        },
        "revisionList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Project"
          }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "ProjectServiceUpdateProjectRevisionBody": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "tagList": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "projectSlug": {
          "type": "string",
          "title": "used to create new projects"
        },
        "gitTags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "gitBranches": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "gitCommitHash": {
          "type": "string"
        },
        "vcsUrl": {
          "type": "string"
        },
        "createdBy": {
          "type": "string"
        },
        "sbomFileUuid": {
          "type": "string"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "ReportsServicePatchReportBody": {
      "type": "object"
    },
    "cvssV2Severity": {
      "type": "string",
      "enum": [
        "CVSS2_SEVERITY_UNSPECIFIED",
        "CVSS2_SEVERITY_LOW",
        "CVSS2_SEVERITY_MEDIUM",
        "CVSS2_SEVERITY_HIGH"
      ],
      "default": "CVSS2_SEVERITY_UNSPECIFIED"
    },
    "cvssV3Severity": {
      "type": "string",
      "enum": [
        "CVSS3_SEVERITY_UNSPECIFIED",
        "CVSS3_SEVERITY_LOW",
        "CVSS3_SEVERITY_MEDIUM",
        "CVSS3_SEVERITY_HIGH",
        "CVSS3_SEVERITY_CRITICAL"
      ],
      "default": "CVSS3_SEVERITY_UNSPECIFIED"
    },
    "cvssV4Severity": {
      "type": "string",
      "enum": [
        "CVSS4_SEVERITY_UNSPECIFIED",
        "CVSS4_SEVERITY_LOW",
        "CVSS4_SEVERITY_MEDIUM",
        "CVSS4_SEVERITY_HIGH",
        "CVSS4_SEVERITY_CRITICAL"
      ],
      "default": "CVSS4_SEVERITY_UNSPECIFIED"
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "v1AnalysisState": {
      "type": "string",
      "enum": [
        "ANALYSIS_STATE_UNSPECIFIED",
        "ANALYSIS_STATE_NOT_STARTED",
        "ANALYSIS_STATE_ASSIGNED",
        "ANALYSIS_STATE_IN_PROGRESS",
        "ANALYSIS_STATE_VERIFICATION",
        "ANALYSIS_STATE_DONE",
        "ANALYSIS_STATE_ERROR",
        "ANALYSIS_STATE_TIMEOUT",
        "ANALYSIS_STATE_CANCELED"
      ],
      "default": "ANALYSIS_STATE_UNSPECIFIED",
      "title": "- ANALYSIS_STATE_NOT_STARTED: analysis job in a queue\n - ANALYSIS_STATE_ASSIGNED: worker is assigned\n - ANALYSIS_STATE_IN_PROGRESS: worker is processing\n - ANALYSIS_STATE_VERIFICATION: worker is verifying and sends analysis results\n - ANALYSIS_STATE_DONE: analysis is done and results are saved\n - ANALYSIS_STATE_ERROR: analysis is finished with error\n - ANALYSIS_STATE_TIMEOUT: analysis is finished with timeout\n - ANALYSIS_STATE_CANCELED: analysis is cancel by user"
    },
    "v1AnalysisStatus": {
      "type": "object",
      "properties": {
        "reportUuid": {
          "type": "string"
        },
        "scannerReports": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1ScannerReport"
          }
        },
        "pipelineId": {
          "type": "string"
        },
        "projectId": {
          "type": "string"
        },
        "repositoryUuid": {
          "type": "string"
        },
        "artifactUuid": {
          "type": "string"
        },
        "workerId": {
          "type": "integer",
          "format": "int64"
        },
        "currentState": {
          "$ref": "#/definitions/v1AnalysisState"
        },
        "isDone": {
          "type": "boolean"
        },
        "progress": {
          "type": "number",
          "format": "float"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "startedAt": {
          "type": "string",
          "format": "date-time"
        },
        "endedAt": {
          "type": "string",
          "format": "date-time"
        },
        "elapsedDuration": {
          "type": "string"
        }
      }
    },
    "v1AnalyzeOptions": {
      "type": "object",
      "properties": {
        "scannerReports": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1ScannerReport"
          }
        },
        "repositoryUuid": {
          "type": "string",
          "title": "create or update project repository by provided attributes"
        },
        "repositoryUrl": {
          "type": "string",
          "title": "ignored if repository_uuid is provided"
        },
        "repositoryRef": {
          "type": "string",
          "title": "added to repository data (can be branch or tag)"
        },
        "artifactUuid": {
          "type": "string",
          "title": "create or update project artifact by provided attributes"
        },
        "artifactPurl": {
          "type": "string",
          "title": "ignored if artifact_uuid is provided"
        },
        "pipelineId": {
          "type": "string",
          "title": "ci/cd attributes"
        },
        "uploadWindow": {
          "type": "integer",
          "format": "int64",
          "title": "defines how long to delay processing"
        },
        "autoCreate": {
          "type": "boolean",
          "title": "defines if non-existing entities (projects, repositories or artifacts) will be created"
        }
      },
      "description": "Contextual metadata accompanying a raw scanner report. It provides information about the environment in which the scan was executed, such as the repository URL, Git reference (branch, tag, commit), pipeline or build ID, and any other relevant deployment or runtime context. This data is used by Dolina ASPM to enrich, filter, and correlate findings with specific code versions or build stages.",
      "title": "Analyze options"
    },
    "v1Component": {
      "type": "object",
      "properties": {
        "uuid": {
          "type": "string"
        },
        "scannerUid": {
          "type": "string",
          "title": "internal scanner component id"
        },
        "purl": {
          "$ref": "#/definitions/v1PURL"
        },
        "type": {
          "$ref": "#/definitions/v1ComponentType"
        },
        "isPublic": {
          "type": "boolean",
          "title": "if component was obtained from public sources (npm, github etc.)"
        },
        "repositoryUuid": {
          "type": "string"
        },
        "repositoryRef": {
          "type": "string"
        },
        "artifactUuid": {
          "type": "string"
        },
        "defectList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Defect"
          }
        },
        "dependencyPurlList": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "list of component dependencies"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "description": "A software component that is part of an application's architecture.Components can include libraries, frameworks, services, containers or other artifacts. Each component tracks metadata such as name, version, type, and securityâ€‘relevant attributes like vulnerabilities, licenses, and dependencies. In Dolina ASPM, components are the primary units for assessing and managing application security posture.",
      "title": "Component"
    },
    "v1ComponentType": {
      "type": "string",
      "enum": [
        "COMPONENT_TYPE_UNSPECIFIED",
        "COMPONENT_TYPE_LANGUAGE_PACKAGE",
        "COMPONENT_TYPE_CONTAINER_IMAGE",
        "COMPONENT_TYPE_OS_PACKAGE",
        "COMPONENT_TYPE_BUNDLE",
        "COMPONENT_TYPE_BINARY_EXECUTABLE",
        "COMPONENT_TYPE_MOBILE_APPLICATION"
      ],
      "default": "COMPONENT_TYPE_UNSPECIFIED"
    },
    "v1ComponentsQueryResponse": {
      "type": "object",
      "properties": {
        "componentsList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Component"
          }
        },
        "pagination": {
          "$ref": "#/definitions/v1PaginationMetadata"
        }
      }
    },
    "v1Defect": {
      "type": "object",
      "properties": {
        "uuid": {
          "type": "string",
          "format": "byte",
          "title": "internal aspm correlation uuid"
        },
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "type": {
          "$ref": "#/definitions/v1DefectType"
        },
        "statusList": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/v1DefectStatus"
          }
        },
        "appliedRiskScore": {
          "type": "integer",
          "format": "int64",
          "title": "applied risk score is based on inputs from security scanners and applied ruleset"
        },
        "cvssScore": {
          "type": "number",
          "format": "float"
        },
        "vulnerability": {
          "$ref": "#/definitions/v1Vulnerability"
        },
        "cweList": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int64"
          }
        },
        "isLatest": {
          "type": "boolean",
          "title": "deduplication"
        },
        "defectDuplicates": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Defect"
          }
        },
        "componentPurl": {
          "type": "string",
          "title": "membership attributes"
        },
        "componentUuid": {
          "type": "string",
          "format": "byte"
        },
        "applicationId": {
          "type": "integer",
          "format": "int64"
        },
        "applicationRef": {
          "type": "string",
          "title": "git ref of an application to define where defect was found"
        },
        "referenceUrlList": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "additional information about defect"
        },
        "fixInfo": {
          "$ref": "#/definitions/v1FixInfo"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "description": "Represents a security defect (vulnerability) identified and tracked within Dolina ASPM. This is the primary entity for managing vulnerabilities, containing enriched information including custom ASPM status, references (e.g., CVE, CWEs), known exploits, an activity log for audit trail, and various internal metadata generated by the ASPM engine during analysis and remediation workflows.",
      "title": "Defect"
    },
    "v1DefectStatus": {
      "type": "string",
      "enum": [
        "DEFECT_STATUS_UNSPECIFIED",
        "DEFECT_STATUS_INDIRECT",
        "DEFECT_STATUS_DIRECT",
        "DEFECT_STATUS_FIXED_BY_UPDATE",
        "DEFECT_STATUS_WILL_NOT_FIX",
        "DEFECT_STATUS_END_OF_LIFE",
        "DEFECT_STATUS_HAS_EXPLOIT"
      ],
      "default": "DEFECT_STATUS_UNSPECIFIED",
      "title": "- DEFECT_STATUS_INDIRECT: defect is indirect for scanner application\n - DEFECT_STATUS_DIRECT: defect is found directly in a scanned application\n - DEFECT_STATUS_FIXED_BY_UPDATE: defect is removed by library/package update\n - DEFECT_STATUS_WILL_NOT_FIX: defect is purposely left in code by distributor\n - DEFECT_STATUS_END_OF_LIFE: defect is found in no longer supported (EOL) package\n - DEFECT_STATUS_HAS_EXPLOIT: defect has known exploit"
    },
    "v1DefectType": {
      "type": "string",
      "enum": [
        "DEFECT_TYPE_UNSPECIFIED",
        "DEFECT_TYPE_SAST",
        "DEFECT_TYPE_SECRETS",
        "DEFECT_TYPE_DAST",
        "DEFECT_TYPE_FUZZING",
        "DEFECT_TYPE_MAST",
        "DEFECT_TYPE_PENTEST",
        "DEFECT_TYPE_OSA",
        "DEFECT_TYPE_SCA",
        "DEFECT_TYPE_IAC",
        "DEFECT_TYPE_ARCH",
        "DEFECT_TYPE_CODE_REVIEW"
      ],
      "default": "DEFECT_TYPE_UNSPECIFIED",
      "title": "- DEFECT_TYPE_SAST: static source code analysis defects\n - DEFECT_TYPE_SECRETS: found secrets (api keys, passwords) in source code or on host\n - DEFECT_TYPE_DAST: dynamic testing (dast) defects\n - DEFECT_TYPE_FUZZING: dynamic testing (fuzzing) defects\n - DEFECT_TYPE_MAST: mobile dynamic testing defects\n - DEFECT_TYPE_PENTEST: penetration testing defects\n - DEFECT_TYPE_OSA: defects found in open source packages\n - DEFECT_TYPE_SCA: software composition (packages and libraries) defects\n - DEFECT_TYPE_IAC: infrastructure as code configuration file defects (Dockerfiles, Terraform, Helm and others)\n - DEFECT_TYPE_ARCH: insecure architecture defect\n - DEFECT_TYPE_CODE_REVIEW: security defect during code review"
    },
    "v1DefectsQueryResponse": {
      "type": "object",
      "properties": {
        "defectsList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Defect"
          }
        },
        "pagination": {
          "$ref": "#/definitions/v1PaginationMetadata"
        }
      }
    },
    "v1Exploit": {
      "type": "object",
      "properties": {
        "uuid": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "referenceUrlList": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "description": "Represents a security exploit with identifying information, description, and external references. Contains a unique identifier (UUID), title, detailed description, list of reference URLs to external resources (CVE, exploit databases, etc.), and optional creation/update timestamps for audit tracking.",
      "title": "Exploit"
    },
    "v1FixInfo": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string"
        },
        "updateVersionList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1FixedVersions"
          }
        },
        "downgradeVersionList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1FixedVersions"
          }
        }
      },
      "description": "Contains information about fix options. Provides a set of version strings representing releases where the vulnerability has been fixed. These versions may be higher (newer) or lower (older patched releases) than the vulnerable version range, indicating all known unaffected versions.",
      "title": "Fix Info"
    },
    "v1FixedVersions": {
      "type": "object",
      "properties": {
        "updateVersionList": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "v1PURL": {
      "type": "object",
      "properties": {
        "instance": {
          "type": "string",
          "title": "string representation of a purl"
        },
        "type": {
          "type": "string",
          "description": "the package \"type\" or package \"protocol\" such as maven, npm, nuget, gem, pypi, etc."
        },
        "namespace": {
          "type": "string",
          "description": "a name prefix such as a Maven group id, a Docker image owner, a GitHub user or organization. Namespace is type-specific."
        },
        "name": {
          "type": "string",
          "description": "the name of the package."
        },
        "version": {
          "type": "string",
          "description": "the name of the package."
        },
        "qualifiers": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "qualifier data for a package such as OS, architecture, repository, etc. Qualifiers are type-specific."
        },
        "subpath": {
          "type": "string",
          "description": "subpath within a package, relative to the package root."
        }
      }
    },
    "v1Pagination": {
      "type": "object",
      "properties": {
        "offset": {
          "type": "integer",
          "format": "int64"
        },
        "limit": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "v1PaginationMetadata": {
      "type": "object",
      "properties": {
        "totalCount": {
          "type": "integer",
          "format": "int64",
          "title": "total number of matching items (if computed)"
        },
        "offset": {
          "type": "integer",
          "format": "int64",
          "title": "current offset"
        },
        "hasNext": {
          "type": "boolean"
        }
      }
    },
    "v1Project": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uint64"
        },
        "name": {
          "type": "string"
        },
        "slug": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "tagList": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "vcsUrl": {
          "type": "string"
        },
        "revisionList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Project"
          }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "v1ProjectsList": {
      "type": "object",
      "properties": {
        "list": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Project"
          }
        }
      }
    },
    "v1Report": {
      "type": "object",
      "properties": {
        "uuid": {
          "type": "string"
        },
        "scannerReports": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1ScannerReport"
          }
        },
        "projectId": {
          "type": "integer",
          "format": "int64",
          "title": "membership attributes"
        },
        "applicationId": {
          "type": "integer",
          "format": "int64"
        },
        "repositoryUuid": {
          "type": "string"
        },
        "artifactUuid": {
          "type": "string"
        },
        "pipelineId": {
          "type": "string",
          "title": "ci/cd attributes"
        }
      },
      "description": "A comprehensive security assessment report generated by Dolina ASPM after analyzing one or more scanner reports. It contains normalized findings, risk scores, severity classifications, remediation recommendations, and contextual metadata (e.g., affected components, code locations). This report provides a unified view of the application's security posture, enabling prioritization and tracking of vulnerabilities across the software development lifecycle.",
      "title": "Report"
    },
    "v1ReportsQueryResponse": {
      "type": "object",
      "properties": {
        "reportsList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Report"
          }
        },
        "pagination": {
          "$ref": "#/definitions/v1PaginationMetadata"
        }
      }
    },
    "v1Revision": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uint64"
        },
        "name": {
          "type": "string"
        },
        "tagList": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "projectId": {
          "type": "string",
          "format": "uint64"
        },
        "projectSlug": {
          "type": "string",
          "title": "used to create new projects"
        },
        "gitTags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "gitBranches": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "gitCommitHash": {
          "type": "string"
        },
        "vcsUrl": {
          "type": "string"
        },
        "createdBy": {
          "type": "string"
        },
        "sbomFileUuid": {
          "type": "string"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "v1ScannerFormat": {
      "type": "string",
      "enum": [
        "SCANNER_FORMAT_UNSPECIFIED",
        "SCANNER_FORMAT_TRIVY_FS",
        "SCANNER_FORMAT_SARIF",
        "SCANNER_FORMAT_SBOM",
        "SCANNER_FORMAT_GITLEAKS"
      ],
      "default": "SCANNER_FORMAT_UNSPECIFIED"
    },
    "v1ScannerID": {
      "type": "string",
      "enum": [
        "SCANNER_ID_UNSPECIFIED",
        "SCANNER_ID_TRIVY",
        "SCANNER_ID_GITLEAKS"
      ],
      "default": "SCANNER_ID_UNSPECIFIED"
    },
    "v1ScannerReport": {
      "type": "object",
      "properties": {
        "uploadedFileUuid": {
          "type": "string"
        },
        "scannerId": {
          "$ref": "#/definitions/v1ScannerID"
        },
        "scannerFormat": {
          "$ref": "#/definitions/v1ScannerFormat"
        }
      },
      "description": "A report generated by an external security scanner (e.g., Trivy, Semgrep, Snyk). It encapsulates raw findings, scan metadata (scanner name, version, timestamp), target information (repository, image, file path), and any additional context required for ingestion. This report serves as the primary input to Dolina ASPM for normalization, deduplication, and risk analysis.",
      "title": "Scanner Report"
    },
    "v1Sort": {
      "type": "object"
    },
    "v1Vendor": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int64"
        },
        "name": {
          "type": "string"
        },
        "url": {
          "type": "string"
        }
      },
      "description": "Vendor entity representing a software or service provider in the ASPM system. Includes identification details, name, description, external references, and audit timestamps for tracking vendor information.",
      "title": "Vendor"
    },
    "v1VendorScoring": {
      "type": "object",
      "properties": {
        "vendor": {
          "$ref": "#/definitions/v1Vendor"
        },
        "cvss2Severity": {
          "$ref": "#/definitions/cvssV2Severity"
        },
        "cvss3Severity": {
          "$ref": "#/definitions/cvssV3Severity"
        },
        "cvss4Severity": {
          "$ref": "#/definitions/cvssV4Severity"
        },
        "cvss2Score": {
          "type": "number",
          "format": "float"
        },
        "cvss3Score": {
          "type": "number",
          "format": "float"
        },
        "cvss4Score": {
          "type": "number",
          "format": "float"
        },
        "cvss2Vector": {
          "type": "string"
        },
        "cvss3Vector": {
          "type": "string"
        },
        "cvss4Vector": {
          "type": "string"
        },
        "sourceUrl": {
          "type": "string"
        }
      },
      "description": "Vendor risk assessment and scoring model. Contains vendor identifier, computed security score, risk factors, assessment methodology details, and timestamps for score validity and updates.",
      "title": "Vendor scoring"
    },
    "v1Vulnerability": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "title": "cve identification, for example CVE-2024-3094, GHSA-cxpw-2g23-2vgw"
        },
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "aggregatedCvssScore": {
          "type": "number",
          "format": "float",
          "title": "aggregated main cvss score"
        },
        "vendorScoringList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1VendorScoring"
          }
        },
        "referenceUrlList": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "additional information about vulnerability"
        },
        "cweList": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int64"
          }
        },
        "vector": {
          "type": "string"
        },
        "hasKnownExploit": {
          "type": "boolean",
          "title": "exploits info"
        },
        "knownExploitList": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1Exploit"
          }
        },
        "source": {
          "type": "string"
        },
        "publishedAt": {
          "type": "string",
          "format": "date-time",
          "title": "timestamps"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "description": "Represents a standardized vulnerability entry from and Advisory (CVE, NVD or other). Contains core vulnerability metadata including CVE ID, description, publication date, severity scores (CVSS), affected components, and remediation information. Serves as the authoritative reference for tracking known security vulnerabilities in the Dolina ASPM system.",
      "title": "Vulnerability"
    }
  }
}
